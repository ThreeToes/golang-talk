package encrypter

import (
	"testing"
	"github.com/stretchr/testify/assert"
)

func TestEncryptData(t *testing.T) {
	payload := `
░░░░░░░█▐▓▓░████▄▄▄█▀▄▓▓▓▌█
░░░░░▄█▌▀▄▓▓▄▄▄▄▀▀▀▄▓▓▓▓▓▌█
░░░▄█▀▀▄▓█▓▓▓▓▓▓▓▓▓▓▓▓▀░▓▌█
░░█▀▄▓▓▓███▓▓▓███▓▓▓▄░░▄▓▐█▌
░█▌▓▓▓▀▀▓▓▓▓███▓▓▓▓▓▓▓▄▀▓▓▐█
▐█▐██▐░▄▓▓▓▓▓▀▄░▀▓▓▓▓▓▓▓▓▓▌█▌
█▌███▓▓▓▓▓▓▓▓▐░░▄▓▓███▓▓▓▄▀▐█
█▐█▓▀░░▀▓▓▓▓▓▓▓▓▓██████▓▓▓▓▐█
▌▓▄▌▀░▀░▐▀█▄▓▓██████████▓▓▓▌█▌
▌▓▓▓▄▄▀▀▓▓▓▀▓▓▓▓▓▓▓▓█▓█▓█▓▓▌█▌
█▐▓▓▓▓▓▓▄▄▄▓▓▓▓▓▓█▓█▓█▓█▓▓▓▐█
	`
	cipherText, err := EncryptData("SuperSneaky", []byte(payload))
	if !assert.Nil(t, err) {
		t.FailNow()
	}
	if !assert.Greater(t, len(cipherText), 0) {
		t.FailNow()
	}

	plainText, err := DecryptData("SuperSneaky", cipherText)
	if !assert.Nil(t, err) {
		t.FailNow()
	}
	if !assert.Equal(t, payload, string(plainText)) {
		t.FailNow()
	}
}
